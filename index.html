<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Contribuyentes</title>
    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbwZXPRy1V7pAB2gXMJ9cCB29eZRtPlC-oCeVngTaix_eB0lAXENZXy8YmZxxJ_njzb-/exec'; // URL de tu aplicación de Apps Script
        async function agregar() {
            const nombre = document.getElementById("nombre").value;
            const apellido = document.getElementById("apellido").value;
            const email = document.getElementById("email").value;
            const telefono = document.getElementById("telefono").value;
            const response = await fetch(`${API_URL}?action=agregarRegistro&nombre=${nombre}&apellido=${apellido}&email=${email}&telefono=${telefono}`, {
                method: 'GET'
            });
            const result = await response.text();
            alert(result);
            document.getElementById("formulario").reset();
        }
        async function obtenerRegistros() {
            const response = await fetch(`${API_URL}?action=obtenerRegistros`, {
                method: 'GET'
            });
            const registros = await response.json();
            mostrarRegistros(registros);
        }
        function mostrarRegistros(registros) {
            const tabla = document.getElementById("tablaRegistros");
            tabla.innerHTML = ""; // Limpiar tabla antes de mostrar registros
            registros.forEach((registro, index) => {
                const fila = document.createElement("tr");
                fila.innerHTML = `<td>${index + 1}</td><td>${registro[0]}</td><td>${registro[1]}</td><td>${registro[2]}</td><td>${registro[3]}</td>`;
                tabla.appendChild(fila);
            });
        }
    </script>
</head>
<body>
    <h1>Agregar Contribuyente</h1>
    <form id="formulario" onsubmit="agregar(); return false;">
        <input type="text" id="nombre" placeholder="Nombre" required>
        <input type="text" id="apellido" placeholder="Apellido" required>
        <input type="email" id="email" placeholder="Email" required>
        <input type="text" id="telefono" placeholder="Teléfono" required>
        <button type="submit">Agregar</button>
    </form>
    <h2>Contribuyentes Registrados</h2>
    <table id="tablaRegistros" border="1">
        <thead>
            <tr>
                <th>#</th>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Email</th>
                <th>Teléfono</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aquí se mostrarán los registros -->
        </tbody>
    </table>
    <script>
        // Cargar registros al cargar la página
        obtenerRegistros();
    </script>
</body>
</html>